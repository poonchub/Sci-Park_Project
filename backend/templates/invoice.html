<!DOCTYPE html>
<html lang="th">
    <head>
        <meta charset="UTF-8" />
        <title>ใบแจ้งหนี้ {{.InvoiceNumber}}</title>

        <!-- Google Fonts -->
        <link rel="preload" href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300;400;500;600;700&family=Sarabun:wght@100;200;300;400;500;600;700;800&display=swap" as="style" />
        <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300;400;500;600;700&family=Sarabun:wght@100;200;300;400;500;600;700;800&display=swap" media="all" />

        <style>
            * {
                font-size: 14px;
                line-height: 1.8rem;
            }
            body {
                font-family: "Sarabun", sans-serif;
                font-weight: 200;
                font-style: normal;
                margin: 60px 100px;
                font-size: 1rem;
            }
            h1 {
                font-weight: 500;
                margin-bottom: 0;
            }
            .header-row {
                display: flex;
                justify-content: space-between;
                align-items: center;
                margin-bottom: 12px;
            }
            .invoice-number {
                margin-top: 20px;
            }
            .text-bold {
                font-weight: 500;
            }
            .text-right {
                text-align: right;
            }
            .text-center {
                text-align: center;
            }

            table {
                width: 100%;
                border-collapse: collapse;
                margin-top: 10px;
            }
            th,
            td {
                border: 1px solid #999;
                padding: 6px 10px;
            }
            th {
                background-color: #ccc;
                font-weight: 500;
            }
            td {
                vertical-align: top;
            }
            .col-description {
                text-align: left;
            }
            .col-month {
                text-align: center;
            }
            .col-amount {
                text-align: right;
            }
            .footer-text {
                margin-top: 20px;
                line-height: 1.2;
            }
            /* กำหนดให้ข้อความใน editor ชิดขอบและขยายความห่างตัวอักษร */
            .editable-content {
                text-align: justify;
                letter-spacing: 0.05em;
            }
        </style>

        <!-- โหลด TinyMCE -->
        <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/6/tinymce.min.js" async referrerpolicy="origin"></script>
    </head>
    <body>
        <div class="header-row">
            <div style="flex: 1">
                <h1 style="border: 2px solid; padding: 4px 0px; text-align: center; width: 80px">ใบแจ้งหนี้</h1>
                <div class="invoice-number">ที่ {{.InvoiceNumber}}</div>
            </div>
            <div style="flex: 2; text-align: center">
                <img src="http:/localhost:8000/images/organization/logo/logo_1.png" alt="Logo" style="max-height: 80px" />
            </div>
            <div style="flex: 1"></div>
        </div>

        <div class="text-right" style="margin: 20px 0px">วันที่ {{ThaiDateFull .IssueDate}}</div>

        <div id="payment-instruction" class="editable-content" style="display: flex; gap: 16px; margin-bottom: 10px">
            <div>
                <span class="text-bold">เรื่อง</span>
            </div>
            <div>แจ้งค่าบริการอาคารอำนวยการอุทยานวิทยาศาสตร์ภูมิภาค ภาคตะวันออกเฉียงเหนือ 2 <br />(จังหวัดนครราชสีมา)</div>
        </div>

        <div id="payment-instruction" class="editable-content" style="display: flex; gap: 16px; margin-bottom: 10px">
            <div>
                <span class="text-bold">เรียน</span>
            </div>
            <div>{{.Customer.CompanyName}}</div>
        </div>

        <!-- ทำให้ส่วนข้อความนี้ editable และจัดชิดขอบโดย TinyMCE -->
        <div id="payment-notice" class="editable-content" style="margin-bottom: 6px; text-indent: 3.2em">
            อุทยานวิทยาศาสตร์ภูมิภาค ภาคตะวันออกเฉียงเหนือ 2 (จังหวัดนครราชสีมา) ขอเรียนให้ท่าน
            <br />ทราบถึงรายการค่าใช้จ่ายต่าง ๆ ต้องชำระดังต่อไปนี้
        </div>

        <table>
            <thead>
                <tr>
                    <th style="text-align: center">รายการ</th>
                    <th class="col-month">เดือน</th>
                    <th style="text-align: center">จำนวนเงิน (บาท)</th>
                </tr>
            </thead>
            <tbody>
                {{range $index, $item := .Items}}
                <tr>
                    <td class="col-description">{{add $index 1}}. {{$item.Description}}</td>
                    <td class="col-month">{{ThaiDateMonthYear $.BillingPeriod}}</td>
                    <td class="col-amount">{{printf "%.2f" $item.Amount}}</td>
                </tr>
                {{end}}
                <tr>
                    <td colspan="2" class="col-amount text-right text-bold">รวมค่าใช้จ่ายประจำเดือน {{ThaiDateMonthYear .BillingPeriod}} ทั้งสิ้น</td>
                    <td class="col-amount text-bold">{{printf "%.2f" .TotalAmount}}</td>
                </tr>
            </tbody>
        </table>

        <!-- ส่วนข้อความที่ต้องการให้ใช้ TinyMCE และจัดชิดขอบ + ขยายความห่างตัวอักษร -->
        <div id="payment-instruction" class="editable-content" style="margin-top: 20px; text-indent: 3.2em">
            จึงขอให้ท่านโปรดชำระค่าบริการ<strong>ภายในวันที่ {{ThaiDateFull .DueDate}}</strong> ที่หน่วยบริหารงานกลางและพัฒนาโครงสร้างพื้นฐาน อุทยานวิทยาศาสตร์ภาคตะวันออกเฉียงเหนือตอนล่าง
            (จ.นครราชสีมา) หรือโอนเงิน<strong>เข้าบัญชีธนาคารกรุงไทย</strong> สาขามหาวิทยาลัยเทคโนโลยีสุรนารี
            <strong>ชื่อบัญชี "RSP นครราชสีมา โดย เทคโนธานี" เลขที่บัญชี 662-1-84151-5</strong>
            และขอให้ท่านส่งหลักฐานการโอนเงินมาที่ หน่วยบริหารงานกลางและพัฒนาโครงสร้างพื้นฐาน อีเมล <strong>office.ne2@gmail.com</strong> เบอร์โทร <strong>099-629-5494</strong>
            เพื่อออกใบเสร็จรับเงิน หากท่านไม่ชำระเงินตามกำหนดดังกล่าว อุทยานวิทยาศาสตร์ฯ ขอสงวนสิทธิ์ดำเนินการปรับตามข้อตกลงตั้งแต่วันผิดข้อตกลงจนกว่าจะชำระเสร็จสิ้น
        </div>

        <div style="margin-top: 10px; text-indent: 3.2em">จึงเรียนมาเพื่อโปรดพิจารณาดำเนินการ</div>

        <div style="height: 40px"></div>

        <div style="display: flex; justify-content: flex-end">
            <div style="width: 240px; text-align: center">
                <span>ขอแสดงความนับถือ</span>
                <div style="flex: 2; text-align: center">
                    <img src="http:/localhost:8000/images/users/user_1/signature.jpg" alt="Logo" style="max-height: 80px" />
                </div>
                <span>({{.Creater.Prefix.PrefixTH}}{{.Creater.FirstName}} {{.Creater.LastName}})</span><br/>
                <span>{{.Creater.Role.Name}}</span>
            </div>
        </div>

        <script>
            tinymce.init({
                selector: ".editable-content",
                menubar: false,
                toolbar: "undo redo | bold italic underline | alignleft aligncenter alignright alignjustify | fontsizeselect | letterspacing",
                plugins: "lists advlist",
                setup: (editor) => {
                    // เพิ่มฟังก์ชันปรับ letter-spacing
                    editor.ui.registry.addSlider("letterspacing", {
                        min: 0,
                        max: 0.2,
                        step: 0.01,
                        value: 0,
                        tooltip: "Letter Spacing",
                        onChange: (value) => {
                            editor.execCommand("mceApplyTextcolor", false, value);
                            editor.getBody().style.letterSpacing = value + "em";
                        },
                    });
                },
            });
        </script>
    </body>
</html>
